## Broken Access Control(Vertical Privilege Escalation)

### Vulnerability Description

Access controls are designed to prevent users from performing actions outside of their expected privileges. When these access controls are vulnerable, users can perform operations outside of their expected privileges, which may allow attackers to steal information from other users, modify data, or perform other sensitive operations as other users.

Access control policies are divided into two categories: horizontal access control and vertical access control, which serve the following purposes, respectively.

- Vertical access control: Different types and privileges of user roles can access different application functions. For example, an administrator may be able to modify or delete any user's account, while ordinary users cannot access these operations.
- Horizontal access control: Different users can access the same type of application functionality. For example, a banking application would allow users to view transactions and make payments from their own accounts, but not allow operations on any other user's account.

Corresponding to the above two access control policies, access control violation vulnerabilities are also divided into two categories: horizontal privilege escalation and vertical privilege escalation.

- Horizontal privilege escalation: A horizontal privilege escalation vulnerability occurs when a user can perform an operation as another user with the same privileges.
- Vertical privilege escalation: A vertical privilege escalation vulnerability occurs when a user can perform an operation that requires a privilege level beyond their role.

This is a Vertical privilege escalation vulnerability.


### Vulnerability Impact

A violated access control puts the application in a high-risk situation, often resulting in compromised data confidentiality and integrity.

* An attacker can execute the actions of a high privileged user through the identity of a low privileged user, manipulate data and steal or modify sensitive information of the application by performing actions that the high privileged user role can perform in the application. * (This paragraph is modified according to the actual situation)


### Repair Recommendation

In general, access control vulnerabilities can be prevented by following the following principles during code development.

1. Never rely solely on obfuscation for access control.
2. Deny access by default unless the resource is intended to be publicly accessible.
3. Whenever possible, use a single application-wide mechanism to enforce access control.
4. At the code level, force developers to declare access rights for each resource and set the default to deny access.
5. Thoroughly audit and test access controls to ensure that they work as designed.


