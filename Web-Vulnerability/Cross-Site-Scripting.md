## 跨站脚本攻击

### 漏洞描述

跨站脚本(XSS)攻击是一种注入类型的攻击，即将恶意脚本注入到本来是良性和可信的网站。
当攻击者使用网络应用程序向不同的终端用户发送恶意代码（通常以浏览器端脚本的形式）时，就会发生XSS攻击。用户在浏览网站、使用即时通讯软件、甚至在阅读电子邮件时，通常会点击其中的链接。攻击者通过在链接中插入恶意代码，就能够盗取用户信息或在终端用户系统上执行恶意代码。

### 漏洞影响

XSS 会给终端用户带来各种问题，其严重程度从烦扰用户到完全的账户泄露不等。
最严重的XSS攻击包括泄露用户的会话cookie、允许攻击者劫持用户的会话并接管账户。其他破坏性攻击包括泄露终端用户文件、安装木马程序、将用户重定向到其他页面或网站、修改内容的展示等。

> 例如: 一个XSS漏洞允许攻击者修改新闻稿或新闻项目，可能会影响公司的股票价格或降低消费者的信心。药品网站上的 XSS 漏洞可能允许攻击者修改剂量信息，导致用药过量。

### 修复建议

根据应用程序的复杂性和处理用户可控数据的方式，可能会困难得多。

一般来说，有效防止XSS漏洞可能涉及以下措施的组合：

- 抵达时过滤输入。在接收用户输入时，根据预期或有效的输入，尽可能严格地进行过滤。

- 在输出时对数据进行编码。在HTTP响应中输出用户可控的数据时，对输出进行编码，防止其被解释为活动内容。根据输出上下文，这可能需要应用HTML、URL、JavaScript和CSS编码的组合。

- 使用适当的响应头。为了防止在不打算包含任何HTML或JavaScript的HTTP响应中出现XSS，您可以使用Content-Type和X-Content-Type-Options头文件，以确保浏览器以您打算的方式解释响应。

- 内容安全策略。作为最后一道防线，您可以使用内容安全策略(CSP)来降低仍然发生的任何XSS漏洞的严重性。

详细修复建议，可参考：
```
https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
```
